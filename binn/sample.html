<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chizel - Galactic Brainrot Battle</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Press+Start+2P&family=Baloo+2:wght@400;700&display=swap">
    <style>
        :root {
            --primary: #6C63FF;
            --secondary: #00F0FF;
            --accent: #FFC107;
            --dark: #0F0E1D;
            --light: #E0F7FF;
            --success: #00FFA3;
            --warning: #FF9F1C;
            --danger: #FF3860;
            --zippy-color: #00F0FF;
            --user-color: #FF9F1C;
            --space-purple: #4B0082;
            --space-blue: #1A1A2E;
            --neon-pink: #FF10F0;
            --neon-green: #39FF14;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Baloo 2', cursive;
            background-color: var(--space-blue);
            color: var(--light);
            height: 100vh;
            overflow: hidden;
            perspective: 1000px;
        }

        .game-container {
            position: relative;
            width: 100%;
            height: 100vh;
            overflow: hidden;
        }

        /* Animated Space Background */
        .space-background {
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at bottom, var(--space-blue) 0%, #000000 100%);
            z-index: -2;
            overflow: hidden;
        }

        .stars {
            position: absolute;
            width: 100%;
            height: 100%;
            background: transparent;
            z-index: -1;
        }

        .star {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            animation: twinkle var(--duration, 5s) infinite ease-in-out;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.2; }
            50% { opacity: 1; }
        }

        .planet {
            position: absolute;
            border-radius: 50%;
            filter: drop-shadow(0 0 20px rgba(255, 255, 255, 0.3));
            animation: float var(--float-duration, 120s) infinite linear;
        }

        @keyframes float {
            0% { transform: translateY(0) translateX(0) rotate(0deg); }
            100% { transform: translateY(-1000px) translateX(500px) rotate(360deg); }
        }

        .comet {
            position: absolute;
            width: 6px;
            height: 6px;
            background: linear-gradient(to right, 
                rgba(255, 255, 255, 0) 0%, 
                rgba(255, 255, 255, 0.8) 50%, 
                rgba(255, 255, 255, 0) 100%);
            border-radius: 50%;
            filter: blur(1px);
            animation: comet var(--comet-duration, 10s) linear infinite;
            opacity: 0;
        }

        @keyframes comet {
            0% { 
                transform: translateX(0) translateY(0);
                opacity: 1;
            }
            100% { 
                transform: translateX(1000px) translateY(500px);
                opacity: 0;
            }
        }

        /* Nebula Animation */
        .nebula {
            position: absolute;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, 
                rgba(106, 13, 173, 0.3) 0%, 
                rgba(48, 63, 159, 0.2) 50%, 
                transparent 70%);
            filter: blur(30px);
            animation: pulse 15s infinite alternate;
            z-index: -1;
        }

        @keyframes pulse {
            0% { transform: scale(0.8); opacity: 0.3; }
            100% { transform: scale(1.2); opacity: 0.6; }
        }

        /* Main Game UI */
        .header {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            z-index: 10;
        }

        .logo {
            height: 50px;
            filter: drop-shadow(0 0 10px var(--secondary));
        }

        .game-stats {
            display: flex;
            gap: 20px;
        }

        /* XP Bar */
        .xp-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .xp-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            color: var(--secondary);
            text-shadow: 0 0 5px var(--secondary);
        }

        .xp-bar {
            width: 200px;
            height: 20px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            overflow: hidden;
            border: 2px solid var(--secondary);
            box-shadow: 0 0 10px var(--secondary);
        }

        .xp-progress {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, 
                var(--primary) 0%, 
                var(--secondary) 50%, 
                var(--neon-pink) 100%);
            border-radius: 8px;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .xp-progress::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                rgba(255, 255, 255, 0.3) 50%, 
                rgba(255, 255, 255, 0.1) 100%);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .xp-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            color: white;
            text-shadow: 0 0 5px white;
        }

        /* Level Display */
        .level-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .level-label {
            font-family: 'Orbitron', sans-serif;
            font-size: 14px;
            color: var(--accent);
            text-shadow: 0 0 5px var(--accent);
        }

        .level-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            color: white;
            text-shadow: 0 0 5px white;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 3px 10px;
            border-radius: 20px;
            border: 2px solid var(--accent);
            box-shadow: 0 0 10px var(--accent);
        }

        /* Characters */
        .character-container {
            position: absolute;
            bottom: 10%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 5%;
            z-index: 5;
        }

        .character {
            position: relative;
            width: 25%;
            max-width: 300px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s ease;
        }

        .character.visible {
            transform: translateY(0);
            opacity: 1;
        }

        .character-image {
            position: relative;
            width: 100%;
            height: auto;
        }

        .character-image img {
            width: 100%;
            height: auto;
            object-fit: contain;
            filter: drop-shadow(0 10px 20px rgba(0, 240, 255, 0.5));
            animation: float 3s ease-in-out infinite;
        }

        /* Speech Bubbles */
        .speech-bubble {
            position: absolute;
            padding: 15px;
            border-radius: 20px;
            max-width: 300px;
            font-size: 18px;
            line-height: 1.4;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            transform: scale(0);
            transform-origin: bottom;
            z-index: 6;
        }

        .speech-bubble.visible {
            transform: scale(1);
        }

        .left-bubble {
            background-color: var(--dark);
            color: var(--light);
            left: 25%;
            bottom: 100%;
            margin-bottom: 20px;
            border: 2px solid var(--zippy-color);
            box-shadow: 0 0 15px var(--zippy-color);
        }

        .left-bubble::after {
            content: '';
            position: absolute;
            left: 20px;
            top: 100%;
            width: 0;
            height: 0;
            border: 15px solid transparent;
            border-top-color: var(--dark);
            border-bottom: 0;
            border-left: 0;
            margin-left: -7.5px;
            filter: drop-shadow(0 5px 5px rgba(0, 0, 0, 0.3));
        }

        .right-bubble {
            background-color: var(--user-color);
            color: var(--dark);
            right: 25%;
            bottom: 100%;
            margin-bottom: 20px;
            border: 2px solid var(--user-color);
            box-shadow: 0 0 15px var(--user-color);
        }

        .right-bubble::after {
            content: '';
            position: absolute;
            right: 20px;
            top: 100%;
            width: 0;
            height: 0;
            border: 15px solid transparent;
            border-top-color: var(--user-color);
            border-bottom: 0;
            border-right: 0;
            margin-right: -7.5px;
            filter: drop-shadow(0 5px 5px rgba(0, 0, 0, 0.3));
        }

        .bubble-content {
            min-height: 40px;
        }

        .typing-indicator {
            display: flex;
            justify-content: center;
            margin-top: 10px;
            gap: 5px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background-color: var(--light);
            border-radius: 50%;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); opacity: 0.6; }
            30% { transform: translateY(-5px); opacity: 1; }
        }

        /* Options Container */
        .options-container {
            position: absolute;
            bottom: 10%;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            width: 80%;
            max-width: 800px;
            padding: 20px;
            background-color: rgba(15, 14, 29, 0.9);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 240, 255, 0.2);
            border: 2px solid var(--secondary);
            z-index: 10;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .options-container.visible {
            opacity: 1;
            pointer-events: all;
        }

        .option-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            font-family: 'Orbitron', sans-serif;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
            box-shadow: 0 5px 15px rgba(0, 240, 255, 0.3);
            flex: 1 1 200px;
            max-width: 300px;
        }

        .option-btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 240, 255, 0.5);
        }

        .option-btn:active {
            transform: translateY(1px);
        }

        /* Task Container */
        .task-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            overflow-y: auto;
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.95) 0%, rgba(15, 14, 29, 0.95) 100%);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--secondary);
            z-index: 20;
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s ease;
            backdrop-filter: blur(10px);
        }

        .task-container.visible {
            opacity: 1;
            pointer-events: all;
        }

        .task-header {
            font-family: 'Press Start 2P', cursive;
            font-size: 22px;
            color: var(--secondary);
            margin-bottom: 25px;
            text-align: center;
            text-shadow: 0 0 10px var(--secondary);
            letter-spacing: 1px;
        }

        .task-content {
            margin-bottom: 25px;
            font-size: 18px;
            line-height: 1.6;
        }

        .task-submit {
            display: block;
            margin: 25px auto 0;
            padding: 12px 35px;
            background: linear-gradient(135deg, var(--success) 0%, var(--neon-green) 100%);
            color: var(--dark);
            border: none;
            border-radius: 50px;
            font-family: 'Orbitron', sans-serif;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(57, 255, 20, 0.4);
        }

        .task-submit:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 20px rgba(57, 255, 20, 0.6);
        }

        .task-submit:active {
            transform: translateY(1px);
        }

        .task-submit.hidden {
            display: none;
        }

        /* Cloud Thinking Box */
        .thinking-box {
            position: absolute;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            max-width: 600px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 50px;
            padding: 30px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            z-index: 15;
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s ease;
            clip-path: polygon(
                0% 20%, 10% 0%, 20% 10%, 30% 0%, 
                40% 10%, 50% 0%, 60% 10%, 70% 0%, 
                80% 10%, 90% 0%, 100% 20%, 
                90% 30%, 100% 40%, 90% 50%, 
                100% 60%, 90% 70%, 100% 80%, 
                80% 100%, 70% 90%, 60% 100%, 
                50% 90%, 40% 100%, 30% 90%, 
                20% 100%, 10% 90%, 0% 80%, 
                10% 70%, 0% 60%, 10% 50%, 
                0% 40%, 10% 30%
            );
            animation: float 6s ease-in-out infinite;
        }

        .thinking-box.visible {
            opacity: 1;
            pointer-events: all;
        }

        .thinking-content {
            color: var(--dark);
            font-size: 18px;
            line-height: 1.6;
            text-align: center;
        }

        /* Brain Teaser Styles */
        .brain-teaser {
            text-align: center;
        }

        .teaser-question {
            font-size: 20px;
            margin-bottom: 25px;
            font-weight: bold;
            color: var(--light);
        }

        .teaser-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .teaser-option {
            padding: 15px;
            background-color: rgba(0, 240, 255, 0.1);
            border: 2px solid var(--secondary);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--light);
            font-size: 16px;
        }

        .teaser-option:hover {
            background-color: rgba(0, 240, 255, 0.3);
            transform: translateX(5px);
        }

        .teaser-option.selected {
            background-color: var(--secondary);
            color: var(--dark);
            font-weight: bold;
            box-shadow: 0 0 15px var(--secondary);
            transform: scale(1.05);
        }

        /* Quick Challenge Styles */
        .quick-challenge {
            text-align: center;
        }

        .challenge-instruction {
            font-size: 18px;
            margin-bottom: 25px;
            color: var(--light);
        }

        .drag-drop-area {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
            gap: 20px;
        }

        .drag-items, .drop-target {
            width: 48%;
            min-height: 200px;
            border: 2px dashed var(--secondary);
            border-radius: 15px;
            padding: 20px;
            background-color: rgba(0, 240, 255, 0.05);
            transition: all 0.3s ease;
        }

        .drag-item {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            cursor: grab;
            font-size: 16px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .drag-item:last-child {
            margin-bottom: 0;
        }

        .drag-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 240, 255, 0.4);
        }

        .drag-item:active {
            cursor: grabbing;
        }

        .drop-target.highlight {
            border-color: var(--success);
            background-color: rgba(0, 255, 163, 0.1);
            box-shadow: 0 0 20px rgba(0, 255, 163, 0.3);
        }

        /* Learn a Fact Styles */
        .learn-fact {
            text-align: center;
        }

        .fact-content {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 25px;
            color: var(--light);
            background-color: rgba(106, 13, 173, 0.2);
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid var(--neon-pink);
        }

        .fact-image {
            max-width: 100%;
            height: auto;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            border: 2px solid var(--secondary);
        }

        .fact-question {
            font-size: 20px;
            margin-bottom: 20px;
            font-weight: bold;
            color: var(--light);
        }

        .fact-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .fact-option {
            padding: 15px;
            background-color: rgba(255, 159, 28, 0.1);
            border: 2px solid var(--user-color);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--light);
            font-size: 16px;
        }

        .fact-option:hover {
            background-color: rgba(255, 159, 28, 0.3);
            transform: translateX(5px);
        }

        .fact-option.selected {
            background-color: var(--user-color);
            color: var(--dark);
            font-weight: bold;
            box-shadow: 0 0 15px var(--user-color);
            transform: scale(1.05);
        }

        /* Coding Challenge Styles */
        .coding-challenge {
            text-align: center;
        }

        .code-instruction {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--light);
        }

        .code-editor {
            width: 100%;
            height: 200px;
            background-color: #1E1E2E;
            border: 2px solid var(--secondary);
            border-radius: 10px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            color: var(--light);
            margin-bottom: 20px;
            resize: none;
            line-height: 1.5;
        }

        .code-output {
            width: 100%;
            min-height: 100px;
            background-color: #1E1E2E;
            border: 2px solid var(--secondary);
            border-radius: 10px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            color: var(--light);
            margin-bottom: 20px;
            text-align: left;
            white-space: pre-wrap;
        }

        /* Memory Game Styles */
        .memory-game {
            text-align: center;
        }

        .memory-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin: 20px auto;
            max-width: 500px;
        }

        .memory-card {
            aspect-ratio: 1;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            transform-style: preserve-3d;
            position: relative;
        }

        .memory-card:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--secondary);
        }

        .memory-card.flipped {
            background: var(--dark);
            transform: rotateY(180deg);
        }

        .memory-card.matched {
            background: var(--success);
            transform: rotateY(180deg);
            cursor: default;
        }

        /* Audio Control */
        .audio-control {
            position: absolute;
            bottom: 20px;
            right: 20px;
            z-index: 10;
        }

        .audio-toggle {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(0, 240, 255, 0.2);
            border: 2px solid var(--secondary);
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0, 240, 255, 0.3);
        }

        .audio-toggle:hover {
            background: rgba(0, 240, 255, 0.4);
            transform: scale(1.1);
        }

        /* Achievement Badges */
        .achievement-badge {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            z-index: 30;
            opacity: 0;
            transition: all 0.5s ease;
            max-width: 400px;
            border: 4px solid var(--accent);
        }

        .achievement-badge.visible {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }

        .badge-icon {
            font-size: 60px;
            margin-bottom: 20px;
            color: var(--accent);
            text-shadow: 0 0 10px var(--accent);
        }

        .badge-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 20px;
            margin-bottom: 15px;
            color: white;
        }

        .badge-desc {
            font-size: 16px;
            margin-bottom: 20px;
            color: white;
        }

        .badge-close {
            padding: 10px 25px;
            background: var(--accent);
            border: none;
            border-radius: 50px;
            font-family: 'Orbitron', sans-serif;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .badge-close:hover {
            transform: scale(1.05);
        }

        /* Confetti Effect */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--primary);
            opacity: 0;
            z-index: 100;
            animation: confetti-fall 5s linear forwards;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .character {
                width: 35%;
            }
            
            .left-bubble, .right-bubble {
                max-width: 250px;
                font-size: 16px;
            }
            
            .options-container {
                width: 90%;
                padding: 15px;
            }
            
            .option-btn {
                font-size: 14px;
                padding: 10px 15px;
            }
            
            .task-container {
                padding: 20px;
            }

            .task-header {
                font-size: 18px;
            }

            .teaser-question, .fact-question {
                font-size: 18px;
            }

            .drag-drop-area {
                flex-direction: column;
            }

            .drag-items, .drop-target {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .character {
                width: 40%;
                bottom: 5%;
            }
            
            .left-bubble {
                left: 15%;
                bottom: 100%;
            }
            
            .right-bubble {
                right: 15%;
                bottom: 100%;
            }
            
            .options-container {
                bottom: 5%;
            }
            
            .xp-bar {
                width: 150px;
            }

            .header {
                flex-direction: column;
                gap: 10px;
                align-items: center;
            }

            .game-stats {
                width: 100%;
                justify-content: space-between;
            }

            .memory-board {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Animation Classes */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .bounce {
            animation: bounce 0.5s ease infinite;
        }

        /* Power Up Effects */
        .power-up-effect {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(0, 240, 255, 0.3) 0%, transparent 70%);
            z-index: 25;
            opacity: 0;
            pointer-events: none;
            animation: pulse 2s infinite;
        }

        /* Story Progress Tracker */
        .story-tracker {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 5px;
            z-index: 10;
        }

        .story-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: rgba(0, 240, 255, 0.3);
            transition: all 0.3s ease;
        }

        .story-dot.active {
            background-color: var(--secondary);
            transform: scale(1.3);
            box-shadow: 0 0 10px var(--secondary);
        }

        /* Inventory Button */
        .inventory-btn {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 20px;
            background: rgba(0, 240, 255, 0.2);
            border: 2px solid var(--secondary);
            border-radius: 50px;
            color: white;
            font-family: 'Orbitron', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .inventory-btn:hover {
            background: rgba(0, 240, 255, 0.4);
            transform: translateX(-50%) scale(1.05);
        }

        /* Inventory Panel */
        .inventory-panel {
            position: absolute;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 800px;
            background: rgba(15, 14, 29, 0.95);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 240, 255, 0.2);
            border: 2px solid var(--secondary);
            z-index: 20;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 15px;
            max-height: 300px;
            overflow-y: auto;
        }

        .inventory-panel.visible {
            opacity: 1;
            pointer-events: all;
        }

        .inventory-item {
            background: rgba(0, 240, 255, 0.1);
            border: 1px solid var(--secondary);
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .inventory-item:hover {
            background: rgba(0, 240, 255, 0.3);
            transform: translateY(-3px);
        }

        .item-icon {
            font-size: 30px;
            margin-bottom: 5px;
            color: var(--secondary);
        }

        .item-name {
            font-size: 12px;
            color: white;
        }

        /* Zippy AI Assistant */
        .zippy-assistant {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 90%;
            max-width: 600px;
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.95) 0%, rgba(15, 14, 29, 0.95) 100%);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--secondary);
            z-index: 30;
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s ease;
            backdrop-filter: blur(10px);
        }

        .zippy-assistant.visible {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
            pointer-events: all;
        }

        .zippy-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .zippy-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 30px;
            color: white;
        }

        .zippy-title {
            font-family: 'Press Start 2P', cursive;
            font-size: 18px;
            color: var(--secondary);
            text-shadow: 0 0 10px var(--secondary);
        }

        .zippy-message {
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 20px;
            color: var(--light);
        }

        .zippy-input {
            width: 100%;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid var(--secondary);
            background-color: rgba(0, 0, 0, 0.3);
            color: white;
            font-family: 'Baloo 2', cursive;
            font-size: 16px;
            margin-bottom: 15px;
            resize: none;
        }

        .zippy-controls {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .zippy-btn {
            padding: 10px 20px;
            border-radius: 50px;
            border: none;
            font-family: 'Orbitron', sans-serif;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .zippy-submit {
            background: linear-gradient(135deg, var(--success) 0%, var(--neon-green) 100%);
            color: var(--dark);
        }

        .zippy-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(57, 255, 20, 0.5);
        }

        .zippy-close {
            background: rgba(255, 56, 96, 0.2);
            color: var(--light);
            border: 2px solid var(--danger);
        }

        .zippy-close:hover {
            background: rgba(255, 56, 96, 0.4);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 56, 96, 0.3);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- Animated Space Background -->
        <div class="space-background">
            <div class="stars" id="stars"></div>
            <div class="nebula" style="top: 20%; left: 10%;"></div>
            <div class="nebula" style="top: 60%; left: 70%;"></div>
            <div class="planet" style="width: 200px; height: 200px; background: radial-gradient(circle at 30% 30%, #4B0082, #1A1A2E); top: 15%; left: 70%; --float-duration: 300s;"></div>
            <div class="planet" style="width: 150px; height: 150px; background: radial-gradient(circle at 30% 30%, #FF9F1C, #FF3860); top: 70%; left: 10%; --float-duration: 250s;"></div>
            <div class="comet" style="top: 10%; left: 5%; --comet-duration: 15s;"></div>
            <div class="comet" style="top: 30%; left: 80%; --comet-duration: 20s;"></div>
        </div>

        <!-- Game Header -->
        <div class="header">
            <img src="assets/logo.png" alt="Chizel Logo" class="logo">
            <div class="game-stats">
                <div class="xp-container">
                    <div class="xp-label">XP:</div>
                    <div class="xp-bar">
                        <div class="xp-progress"></div>
                    </div>
                    <div class="xp-value">0</div>
                </div>
                <div class="level-container">
                    <div class="level-label">LEVEL:</div>
                    <div class="level-value">1</div>
                </div>
            </div>
        </div>

        <!-- Characters -->
        <div class="character-container">
            <div class="character left">
                <div class="character-image">
                    <img src="assets/zippy.png" alt="Zippy the AI Mentor">
                </div>
            </div>
            <div class="character right">
                <div class="character-image">
                    <img src="assets/user.png" alt="You">
                </div>
            </div>
        </div>

        <!-- Speech Bubbles -->
        <div class="speech-bubble left-bubble">
            <div class="bubble-content"></div>
            <div class="typing-indicator">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
        </div>
        
        <div class="speech-bubble right-bubble">
            <div class="bubble-content"></div>
        </div>

        <!-- Options Container -->
        <div class="options-container"></div>

        <!-- Task Container -->
        <div class="task-container">
            <div class="task-header"></div>
            <div class="task-content"></div>
            <button class="task-submit hidden">Submit</button>
        </div>

        <!-- Cloud Thinking Box -->
        <div class="thinking-box">
            <div class="thinking-content"></div>
        </div>

        <!-- Audio Control -->
        <div class="audio-control">
            <button class="audio-toggle">üîä</button>
        </div>

        <!-- Story Progress Tracker -->
        <div class="story-tracker" id="story-tracker"></div>

        <!-- Inventory Button -->
        <button class="inventory-btn" id="inventory-btn">
            <span>üõçÔ∏è</span> Inventory
        </button>

        <!-- Inventory Panel -->
        <div class="inventory-panel" id="inventory-panel"></div>

        <!-- Achievement Badge -->
        <div class="achievement-badge" id="achievement-badge">
            <div class="badge-icon">üèÜ</div>
            <div class="badge-title">ACHIEVEMENT UNLOCKED!</div>
            <div class="badge-desc">You earned the 'Quick Learner' badge!</div>
            <button class="badge-close">Awesome!</button>
        </div>

        <!-- Power Up Effect -->
        <div class="power-up-effect" id="power-up-effect"></div>

        <!-- Zippy AI Assistant -->
        <div class="zippy-assistant" id="zippy-assistant">
            <div class="zippy-header">
                <div class="zippy-avatar">Z</div>
                <div class="zippy-title">ZIPPY AI ASSISTANT</div>
            </div>
            <div class="zippy-message" id="zippy-message">How can I help you on your mission today?</div>
            <textarea class="zippy-input" id="zippy-input" placeholder="Ask me anything about the mission..."></textarea>
            <div class="zippy-controls">
                <button class="zippy-btn zippy-close" id="zippy-close">Close</button>
                <button class="zippy-btn zippy-submit" id="zippy-submit">Ask</button>
            </div>
        </div>
    </div>

    <script>
        // Game State
        const gameState = {
            currentStep: 0,
            xp: localStorage.getItem('chizelXP') ? parseInt(localStorage.getItem('chizelXP')) : 0,
            level: localStorage.getItem('chizelLevel') ? parseInt(localStorage.getItem('chizelLevel')) : 1,
            completedTasks: JSON.parse(localStorage.getItem('chizelCompletedTasks')) || [],
            inventory: JSON.parse(localStorage.getItem('chizelInventory')) || [],
            achievements: JSON.parse(localStorage.getItem('chizelAchievements')) || [],
            audioEnabled: true,
            currentTask: null,
            taskCompleted: false,
            brainrotHealth: 100,
            userHealth: 100,
            storyProgress: 0,
            zippyKnowledge: {}
        };

        // DOM Elements
        const elements = {
            leftCharacter: document.querySelector('.character.left'),
            rightCharacter: document.querySelector('.character.right'),
            leftBubble: document.querySelector('.left-bubble'),
            rightBubble: document.querySelector('.right-bubble'),
            leftBubbleContent: document.querySelector('.left-bubble .bubble-content'),
            rightBubbleContent: document.querySelector('.right-bubble .bubble-content'),
            optionsContainer: document.querySelector('.options-container'),
            xpBar: document.querySelector('.xp-progress'),
            xpValue: document.querySelector('.xp-value'),
            levelValue: document.querySelector('.level-value'),
            taskContainer: document.querySelector('.task-container'),
            taskContent: document.querySelector('.task-content'),
            taskSubmit: document.querySelector('.task-submit'),
            taskHeader: document.querySelector('.task-header'),
            audioToggle: document.querySelector('.audio-toggle'),
            typingIndicator: document.querySelector('.typing-indicator'),
            thinkingBox: document.querySelector('.thinking-box'),
            thinkingContent: document.querySelector('.thinking-content'),
            starsContainer: document.getElementById('stars'),
            storyTracker: document.getElementById('story-tracker'),
            inventoryBtn: document.getElementById('inventory-btn'),
            inventoryPanel: document.getElementById('inventory-panel'),
            achievementBadge: document.getElementById('achievement-badge'),
            powerUpEffect: document.getElementById('power-up-effect'),
            zippyAssistant: document.getElementById('zippy-assistant'),
            zippyMessage: document.getElementById('zippy-message'),
            zippyInput: document.getElementById('zippy-input'),
            zippySubmit: document.getElementById('zippy-submit'),
            zippyClose: document.getElementById('zippy-close')
        };

        // Audio Elements
        const audio = {
            success: new Audio('assets/success.mp3'),
            notification: new Audio('assets/notification.mp3'),
            powerup: new Audio('assets/powerup.mp3'),
            achievement: new Audio('assets/achievement.mp3'),
            typing: new Audio('assets/typing.mp3'),
            battle: new Audio('assets/battle.mp3')
        };

        // Create stars for background
        function createStars() {
            for (let i = 0; i < 200; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.width = `${Math.random() * 3 + 1}px`;
                star.style.height = star.style.width;
                star.style.left = `${Math.random() * 100}%`;
                star.style.top = `${Math.random() * 100}%`;
                star.style.opacity = Math.random();
                star.style.animationDelay = `${Math.random() * 5}s`;
                star.style.setProperty('--duration', `${Math.random() * 3 + 2}s`);
                elements.starsContainer.appendChild(star);
            }
        }

        // Extended Story Script with Brainrot Battle Theme
        const storyScript = [
            // Introduction
            {
                speaker: 'zippy',
                message: "üö® ALERT! üö® This is Commander Zippy of the Chizel Starship! The galaxy is under attack by the evil BRAINROT!",
                options: [
                    { text: "What's Brainrot?", nextStep: 1, xp: 5 },
                    { text: "How can I help?", nextStep: 2, xp: 5 }
                ],
                thinking: "Brainrot is a cosmic entity that drains knowledge from young minds across the galaxy, replacing it with mindless scrolling and wasted time..."
            },
            {
                speaker: 'zippy',
                message: "Brainrot is a knowledge-draining cosmic parasite! It feeds on wasted potential and turns bright young minds into zombies!",
                options: [
                    { text: "That's terrifying!", nextStep: 3, xp: 5 },
                    { text: "What's its weakness?", nextStep: 4, xp: 5 }
                ],
                thinking: "Our scanners show Brainrot's core is vulnerable to concentrated bursts of knowledge and skill-building..."
            },
            {
                speaker: 'zippy',
                message: "We need YOU to pilot our XP Cannon! Each skill you master fires knowledge missiles that weaken Brainrot's defenses!",
                options: [
                    { text: "I'm ready to fight!", nextStep: 5, xp: 10 },
                    { text: "How does the XP Cannon work?", nextStep: 6, xp: 5 }
                ],
                thinking: "The XP Cannon converts your learning into pure energy. More XP = stronger attacks against Brainrot!"
            },
            {
                speaker: 'zippy',
                message: "Don't worry cadet! With Chizel's training system, we'll turn you into a Skillionaire Warrior in no time!",
                options: [
                    { text: "What's first?", nextStep: 7, xp: 5 },
                    { text: "Show me Brainrot!", nextStep: 8, xp: 5 }
                ],
                thinking: "Initializing combat simulation... preparing first training mission..."
            },
            {
                speaker: 'zippy',
                message: "Brainrot hates LEARNING! Every math problem solved, every fact memorized weakens its power over young minds!",
                options: [
                    { text: "Let's learn then!", nextStep: 7, xp: 10 },
                    { text: "Show me the enemy!", nextStep: 8, xp: 5 }
                ],
                thinking: "Scanning Brainrot's energy signature... detecting high concentrations near social media and gaming platforms..."
            },
            {
                speaker: 'zippy',
                message: "That's the spirit! Your first mission has three phases: Logic Training, Memory Boost, and Coding Power-Up!",
                options: [],
                action: 'startTasks',
                thinking: "Mission parameters set. Engaging safety protocols. Remember cadet: in Chizel, we turn screen time into SKILL time!"
            },
            {
                speaker: 'zippy',
                message: "The XP Cannon charges as you complete challenges! Each level unlocks new weapons against Brainrot!",
                options: [
                    { text: "Understood!", nextStep: 5, xp: 5 },
                    { text: "What kind of weapons?", nextStep: 9, xp: 5 }
                ],
                thinking: "Weapon systems include: Math Missiles, Vocabulary Lasers, and the ultimate History Hyperbeam!"
            },
            {
                speaker: 'zippy',
                message: "ACTIVATE VIEWSCREEN! *static* This is Brainrot's current form... it's already infected 78% of young minds in this sector!",
                options: [
                    { text: "We have to stop it!", nextStep: 5, xp: 10 },
                    { text: "It's huge!", nextStep: 10, xp: 5 }
                ],
                thinking: "Analysis: Brainrot manifestation appears as infinite scroll feeds and auto-play videos... must... resist... clicking..."
            },
            {
                speaker: 'zippy',
                message: "At level 5 you unlock Math Missiles! Level 10 gets Vocabulary Lasers! The ultimate History Hyperbeam requires level 20!",
                options: [
                    { text: "I'll level up fast!", nextStep: 5, xp: 10 },
                    { text: "Tell me more", nextStep: 11, xp: 5 }
                ],
                thinking: "Pro tip: Completing bonus challenges gives XP boosts! Watch for flashing asteroids - they contain power-ups!"
            },
            {
                speaker: 'zippy',
                message: "Our scanners show Brainrot is WEAK against: Critical Thinking, Problem Solving, and Creative Expression!",
                options: [
                    { text: "My brain is ready!", nextStep: 5, xp: 10 },
                    { text: "What else hurts it?", nextStep: 12, xp: 5 }
                ],
                thinking: "Interesting... Brainrot's energy signature fluctuates when exposed to genuine curiosity and perseverance..."
            },
            {
                speaker: 'zippy',
                message: "Each skill you master creates a 'Knowledge Shield' that protects you from Brainrot's attention-draining attacks!",
                options: [
                    { text: "Let's build shields!", nextStep: 5, xp: 10 },
                    { text: "How strong are they?", nextStep: 13, xp: 5 }
                ],
                thinking: "Calculating shield strength... current projection: 1 skill = 5% resistance to distraction attacks..."
            },
            {
                speaker: 'zippy',
                message: "A fully charged History Hyperbeam can wipe out a Brainrot tendril in one shot! But it requires mastering 50 history facts!",
                options: [
                    { text: "I'll start studying!", nextStep: 5, xp: 15 },
                    { text: "What about other subjects?", nextStep: 14, xp: 5 }
                ],
                thinking: "Cross-indexing curriculum with combat effectiveness... math skills particularly potent against probability manipulators..."
            },
            {
                speaker: 'zippy',
                message: "Shield strength increases exponentially! 5 skills = 30% resistance! 10 skills = 60%! Max level = 95% resistance!",
                options: [
                    { text: "I want max shields!", nextStep: 5, xp: 15 },
                    { text: "What about armor?", nextStep: 15, xp: 5 }
                ],
                thinking: "Developing anti-Brainrot armor prototypes... current design uses spaced repetition plating and active recall alloy..."
            },
            {
                speaker: 'zippy',
                message: "Science gives EMP grenades! Literature provides Decryption Codes! Even Art Skills can disrupt Brainrot's visual hypnosis!",
                options: [
                    { text: "I'll learn everything!", nextStep: 5, xp: 20 },
                    { text: "Let's fight now!", nextStep: 5, xp: 10 }
                ],
                thinking: "Warning: Brainrot adapts quickly! Recommend varied skill development to prevent resistance buildup..."
            },
            {
                speaker: 'zippy',
                message: "Our engineers are working on Focus Helmets and Productivity Gauntlets! Earn them by completing achievement chains!",
                options: [
                    { text: "I want that gear!", nextStep: 5, xp: 15 },
                    { text: "Show me achievements", nextStep: 16, xp: 5 }
                ],
                thinking: "Current prototype: Pomodoro Plasma Rifle - fires 25-minute concentration bursts with 5-minute shield recharge..."
            },
            {
                speaker: 'zippy',
                message: "Achievements unlock special abilities! 'Quick Learner' boosts XP! 'Streak Master' gives daily bonuses!",
                options: [
                    { text: "How do I earn them?", nextStep: 17, xp: 5 },
                    { text: "Let's just fight!", nextStep: 5, xp: 10 }
                ],
                thinking: "Achievement system uses operant conditioning principles... carefully calibrated reward schedules maximize engagement..."
            },
            {
                speaker: 'zippy',
                message: "Complete challenges in record time! Maintain daily streaks! Help other cadets! The more you do, the more you unlock!",
                options: [
                    { text: "I'll go for all!", nextStep: 5, xp: 20 },
                    { text: "Enough talk - FIGHT!", nextStep: 5, xp: 10 }
                ],
                thinking: "Cadet shows promising motivation levels... initiating combat training sequence..."
            },
            // After tasks are completed
            {
                speaker: 'zippy',
                message: "‚ö° MISSION ACCOMPLISHED! ‚ö° You've earned 150 XP and weakened Brainrot's hold on this sector!",
                options: [],
                action: 'showFinalMessage',
                thinking: "Scanning results... Brainrot energy signature reduced by 23% in this quadrant... excellent work cadet!"
            }
        ];

        // Initialize Zippy's knowledge base
        function initZippyKnowledge() {
            gameState.zippyKnowledge = {
                "brainrot": "Brainrot is a cosmic entity that drains knowledge from young minds. It manifests as endless scrolling, wasted time, and unproductive screen use. Weaknesses include: learning activities, skill-building, and focused attention.",
                "chizel": "Chizel is an intergalactic initiative to turn screen time into skill time. Our mission: equip young minds with knowledge weapons to fight Brainrot and become Skillionaires!",
                "xp": "XP (Experience Points) measure your learning progress. Earn XP by completing challenges. More XP = stronger attacks against Brainrot and cooler upgrades!",
                "mission": "Your current mission: Complete training challenges to power up the XP Cannon. We need to weaken Brainrot's hold on this sector by at least 20%.",
                "weapons": "Available weapons: Math Missiles (unlock at Lv5), Vocabulary Lasers (Lv10), History Hyperbeam (Lv20). Each requires mastering specific skills.",
                "skills": "Critical skills against Brainrot: Problem Solving, Memory Training, Logical Thinking, Creativity, and Focus. Developing these creates Knowledge Shields.",
                "levels": "Level up by earning XP. Each level unlocks new abilities. Level 1-5: Cadet, 6-10: Officer, 11-20: Commander, 20+: Skillionaire Champion!",
                "achievements": "Achievements reward special accomplishments. Examples: 'Quick Learner' (complete 3 tasks fast), 'Streak Master' (7 daily logins), 'Knowledge Warrior' (50 correct answers).",
                "inventory": "Your inventory holds power-ups and collectibles. Earn them by completing challenges or finding hidden items. Use them strategically in battle!",
                "help": "I'm here to help with: mission info, Brainrot facts, XP explanations, achievement tracking, and learning strategies. Ask me anything!",
                "story": "The Chizel storyline: In the year 2042, Brainrot emerged from the digital dimension, draining knowledge from millions. The Chizel Initiative was founded to fight back using gamified learning."
            };
        }

        // Extended Task Data with Space Theme
        const tasks = [
            {
                id: 'brain-teaser',
                title: "LOGIC TRAINING: XP Cannon Calibration",
                type: "brain-teaser",
                question: "To calibrate the XP Cannon, solve this: If an asteroid hits Brainrot for 15 damage and another hits for 20, but Brainrot regenerates 10 health, what's the total damage?",
                options: ["25 damage", "35 damage", "30 damage", "5 damage"],
                correctAnswer: 0,
                xp: 50,
                thinking: "Remember cadet: total damage = (15 + 20) - 10 regeneration = 25. This calibrates our weapons perfectly!"
            },
            {
                id: 'memory-game',
                title: "MEMORY BOOST: Shield Pattern Sequence",
                type: "memory-game",
                pairs: ["‚ö°", "üîã", "üöÄ", "üõ°Ô∏è", "üåå", "üéØ", "üß†", "üí°"],
                xp: 50,
                thinking: "Matching these symbols trains your hippocampus - the brain's memory center. Stronger memory = better shield patterns!"
            },
            {
                id: 'coding-challenge',
                title: "CODING POWER-UP: Shield Algorithm",
                type: "coding-challenge",
                instruction: "Debug this shield algorithm by fixing the syntax errors:",
                code: `function activateShield(strength) {\n  if strength > 50\n    return "MAX POWER!"\n  else\n    console.log("Shield at " + strength + "%")\n}`,
                correctAnswer: `function activateShield(strength) {\n  if (strength > 50) {\n    return "MAX POWER!";\n  } else {\n    console.log("Shield at " + strength + "%");\n  }\n}`,
                xp: 50,
                thinking: "Proper syntax is crucial for shield stability! Remember your curly braces and parentheses cadet!"
            },
            {
                id: 'quick-challenge',
                title: "SPACE NAVIGATION: Planet Order Challenge",
                type: "quick-challenge",
                instruction: "Drag the planets to order them by distance from the Sun:",
                items: ["Mars", "Venus", "Earth", "Mercury"],
                correctOrder: ["Mercury", "Venus", "Earth", "Mars"],
                xp: 50,
                thinking: "Correct order: Mercury, Venus, Earth, Mars. Knowing planetary positions helps navigate while dodging Brainrot's attacks!"
            },
            {
                id: 'learn-fact',
                title: "SCIENCE FACT: Nebula Knowledge",
                type: "learn-fact",
                fact: "A nebula is a giant cloud of dust and gas in space. Some nebulae come from dying stars, while others are regions where new stars are being born!",
                question: "What is a nebula primarily made of?",
                options: ["Rock and metal", "Dust and gas", "Plasma only", "Dark matter"],
                correctAnswer: 1,
                xp: 50,
                thinking: "Nebulae are star nurseries made of dust and gas. This knowledge helps repair our ship's plasma filters!"
            }
        ];

        // Achievements Data
        const achievements = [
            {
                id: 'quick-learner',
                title: "Quick Learner",
                description: "Completed 3 tasks in record time!",
                icon: "üèéÔ∏è",
                xpBonus: 20
            },
            {
                id: 'streak-starter',
                title: "Streak Starter",
                description: "Logged in 3 days in a row!",
                icon: "üî•",
                xpBonus: 30
            },
            {
                id: 'brainrot-basher',
                title: "Brainrot Basher",
                description: "Defeated Brainrot in 5 battles!",
                icon: "üëä",
                xpBonus: 50
            },
            {
                id: 'knowledge-knight',
                title: "Knowledge Knight",
                description: "Earned 500 XP!",
                icon: "üõ°Ô∏è",
                xpBonus: 75
            }
        ];

        // Inventory Items
        const inventoryItems = [
            {
                id: 'xp-boost',
                name: "XP Boost",
                description: "+20% XP for 1 hour",
                icon: "‚ö°"
            },
            {
                id: 'shield-cell',
                name: "Shield Cell",
                description: "Restores 25% shield",
                icon: "üõ°Ô∏è"
            },
            {
                id: 'brainrot-scanner',
                name: "Brainrot Scanner",
                description: "Reveals weak points",
                icon: "üì°"
            },
            {
                id: 'knowledge-grenade',
                name: "Knowledge Grenade",
                description: "Deals 50 damage",
                icon: "üí£"
            }
        ];

        // Initialize the game
        function initGame() {
            createStars();
            initZippyKnowledge();
            updateXPDisplay();
            updateLevel();
            showStoryStep(0);
            createStoryTracker();
            
            // Set up audio toggle
            elements.audioToggle.addEventListener('click', toggleAudio);
            
            // Set up task submit button
            elements.taskSubmit.addEventListener('click', checkTaskAnswer);
            
            // Set up inventory button
            elements.inventoryBtn.addEventListener('click', toggleInventory);
            
            // Set up Zippy AI assistant
            elements.zippyClose.addEventListener('click', () => toggleZippyAssistant(false));
            elements.zippySubmit.addEventListener('click', handleZippyQuery);
            elements.zippyInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleZippyQuery();
            });
            
            // Show characters with animation
            setTimeout(() => {
                elements.leftCharacter.classList.add('visible');
                elements.rightCharacter.classList.add('visible');
            }, 500);
            
            // Check for achievements
            checkAchievements();
        }

        // Create story progress tracker
        function createStoryTracker() {
            elements.storyTracker.innerHTML = '';
            for (let i = 0; i < storyScript.length; i++) {
                const dot = document.createElement('div');
                dot.className = 'story-dot';
                if (i === gameState.currentStep) {
                    dot.classList.add('active');
                }
                elements.storyTracker.appendChild(dot);
            }
        }

        // Update story tracker
        function updateStoryTracker() {
            const dots = document.querySelectorAll('.story-dot');
            dots.forEach((dot, index) => {
                if (index === gameState.currentStep) {
                    dot.classList.add('active');
                } else {
                    dot.classList.remove('active');
                }
            });
        }

        // Show story step
        function showStoryStep(stepIndex) {
            gameState.currentStep = stepIndex;
            const step = storyScript[stepIndex];
            
            if (!step) return;
            
            // Update story progress
            gameState.storyProgress = (stepIndex / storyScript.length) * 100;
            
            // Clear options
            elements.optionsContainer.innerHTML = '';
            elements.optionsContainer.classList.remove('visible');
            
            // Hide right bubble if it's Zippy's turn to speak
            elements.rightBubble.classList.remove('visible');
            
            if (step.speaker === 'zippy') {
                // Show thinking box if available
                if (step.thinking) {
                    elements.thinkingContent.textContent = step.thinking;
                    elements.thinkingBox.classList.add('visible');
                }
                
                // Show typing indicator
                elements.typingIndicator.style.display = 'flex';
                elements.leftBubble.classList.remove('hidden');
                
                // Play typing sound if audio is enabled
                if (gameState.audioEnabled) {
                    audio.typing.currentTime = 0;
                    audio.typing.play();
                }
                
                // Type out the message
                typeMessage(step.message, elements.leftBubbleContent, () => {
                    // Hide typing indicator when done
                    elements.typingIndicator.style.display = 'none';
                    audio.typing.pause();
                    
                    // Show bubble
                    elements.leftBubble.classList.add('visible');
                    
                    // Hide thinking box after a delay
                    if (step.thinking) {
                        setTimeout(() => {
                            elements.thinkingBox.classList.remove('visible');
                        }, 2000);
                    }
                    
                    // If there's an action, perform it
                    if (step.action) {
                        performAction(step.action);
                    }
                    
                    // Show options if they exist
                    if (step.options && step.options.length > 0) {
                        showOptions(step.options);
                    }
                });
            } else {
                // For user responses
                elements.rightBubbleContent.textContent = step.message;
                elements.rightBubble.classList.add('visible');
                
                // Move to next step after delay
                setTimeout(() => {
                    showStoryStep(step.nextStep);
                }, 1500);
            }
            
            // Update story tracker
            updateStoryTracker();
        }

        // Type message with typing animation
        function typeMessage(message, element, callback) {
            let i = 0;
            element.textContent = '';
            
            function typing() {
                if (i < message.length) {
                    element.textContent += message.charAt(i);
                    i++;
                    setTimeout(typing, 30);
                } else if (callback) {
                    callback();
                }
            }
            
            typing();
        }

        // Show response options
        function showOptions(options) {
            elements.optionsContainer.innerHTML = '';
            
            options.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-btn';
                button.textContent = option.text;
                
                button.addEventListener('click', () => {
                    // Play sound if audio is enabled
                    if (gameState.audioEnabled) {
                        audio.notification.currentTime = 0;
                        audio.notification.play();
                    }
                    
                    // Show user's response
                    showUserResponse(option.text);
                    
                    // Add XP if specified
                    if (option.xp) {
                        addXP(option.xp);
                    }
                    
                    // Move to next step after delay
                    setTimeout(() => {
                        if (option.nextStep !== undefined) {
                            showStoryStep(option.nextStep);
                        }
                    }, 1500);
                });
                
                elements.optionsContainer.appendChild(button);
            });
            
            elements.optionsContainer.classList.add('visible');
        }

        // Show user response in bubble
        function showUserResponse(message) {
            elements.rightBubbleContent.textContent = message;
            elements.rightBubble.classList.add('visible');
            elements.optionsContainer.classList.remove('visible');
        }

        // Perform special action
        function performAction(action) {
            switch (action) {
                case 'startTasks':
                    startTasks();
                    break;
                case 'showFinalMessage':
                    showFinalMessage();
                    break;
            }
        }

        // Start tasks
        function startTasks() {
            // Reset completed tasks
            gameState.completedTasks = [];
            gameState.taskCompleted = false;
            
            // Show first task
            showTask(0);
        }

        // Show task
        function showTask(taskIndex) {
            if (taskIndex >= tasks.length) {
                // All tasks completed
                showStoryStep(storyScript.length - 1); // Show final message
                return;
            }
            
            const task = tasks[taskIndex];
            gameState.currentTask = task;
            
            // Set task header
            elements.taskHeader.textContent = task.title;
            
            // Clear previous task content
            elements.taskContent.innerHTML = '';
            elements.taskSubmit.classList.add('hidden');
            
            // Show thinking box if available
            if (task.thinking) {
                elements.thinkingContent.textContent = task.thinking;
                elements.thinkingBox.classList.add('visible');
            }
            
            // Create task based on type
            switch (task.type) {
                case 'brain-teaser':
                    createBrainTeaser(task);
                    break;
                case 'memory-game':
                    createMemoryGame(task);
                    break;
                case 'coding-challenge':
                    createCodingChallenge(task);
                    break;
                case 'quick-challenge':
                    createQuickChallenge(task);
                    break;
                case 'learn-fact':
                    createLearnFact(task);
                    break;
            }
            
            // Show task container
            elements.taskContainer.classList.add('visible');
        }

        // Create brain teaser task
        function createBrainTeaser(task) {
            const container = document.createElement('div');
            container.className = 'brain-teaser';
            
            const question = document.createElement('div');
            question.className = 'teaser-question';
            question.textContent = task.question;
            container.appendChild(question);
            
            const options = document.createElement('div');
            options.className = 'teaser-options';
            
            task.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'teaser-option';
                optionElement.textContent = option;
                
                optionElement.addEventListener('click', () => {
                    // Remove selected class from all options
                    document.querySelectorAll('.teaser-option').forEach(el => {
                        el.classList.remove('selected');
                    });
                    
                    // Add selected class to clicked option
                    optionElement.classList.add('selected');
                    
                    // Store selected answer
                    gameState.currentTask.selectedAnswer = index;
                    
                    // Show submit button
                    elements.taskSubmit.classList.remove('hidden');
                });
                
                options.appendChild(optionElement);
            });
            
            container.appendChild(options);
            elements.taskContent.appendChild(container);
        }

        // Create memory game task
        function createMemoryGame(task) {
            const container = document.createElement('div');
            container.className = 'memory-game';
            
            const instruction = document.createElement('div');
            instruction.className = 'challenge-instruction';
            instruction.textContent = "Match the pairs to strengthen your memory shields!";
            container.appendChild(instruction);
            
            // Duplicate and shuffle the pairs
            const cards = [...task.pairs, ...task.pairs];
            shuffleArray(cards);
            
            const board = document.createElement('div');
            board.className = 'memory-board';
            
            // Track flipped cards
            let flippedCards = [];
            let matchedPairs = 0;
            
            cards.forEach((symbol, index) => {
                const card = document.createElement('div');
                card.className = 'memory-card';
                card.dataset.index = index;
                card.dataset.symbol = symbol;
                
                card.addEventListener('click', () => {
                    // Don't allow flipping if already flipped or matched
                    if (card.classList.contains('flipped') || 
                        card.classList.contains('matched') ||
                        flippedCards.length >= 2) {
                        return;
                    }
                    
                    // Flip the card
                    card.classList.add('flipped');
                    card.textContent = symbol;
                    flippedCards.push(card);
                    
                    // Check for match when two cards are flipped
                    if (flippedCards.length === 2) {
                        if (flippedCards[0].dataset.symbol === flippedCards[1].dataset.symbol) {
                            // Match found
                            flippedCards.forEach(c => {
                                c.classList.add('matched');
                                c.classList.remove('flipped');
                            });
                            matchedPairs++;
                            
                            // Check if all pairs are matched
                            if (matchedPairs === task.pairs.length) {
                                gameState.currentTask.completed = true;
                                elements.taskSubmit.classList.remove('hidden');
                            }
                        } else {
                            // No match - flip back after delay
                            setTimeout(() => {
                                flippedCards.forEach(c => {
                                    c.classList.remove('flipped');
                                    c.textContent = '';
                                });
                                flippedCards = [];
                            }, 1000);
                        }
                    }
                });
                
                board.appendChild(card);
            });
            
            container.appendChild(board);
            elements.taskContent.appendChild(container);
        }

        // Create coding challenge task
        function createCodingChallenge(task) {
            const container = document.createElement('div');
            container.className = 'coding-challenge';
            
            const instruction = document.createElement('div');
            instruction.className = 'code-instruction';
            instruction.textContent = task.instruction;
            container.appendChild(instruction);
            
            const editor = document.createElement('textarea');
            editor.className = 'code-editor';
            editor.textContent = task.code;
            container.appendChild(editor);
            
            const output = document.createElement('div');
            output.className = 'code-output';
            output.textContent = "Debug the code above to see the output here...";
            container.appendChild(output);
            
            const runBtn = document.createElement('button');
            runBtn.className = 'task-submit';
            runBtn.textContent = "Run Code";
            runBtn.addEventListener('click', () => {
                try {
                    // In a real app, you'd use a proper code evaluation method
                    if (editor.value.trim() === task.correctAnswer) {
                        output.textContent = "Shield algorithm activated successfully!\nOutput: Shield at 100%";
                        output.style.color = "var(--success)";
                        gameState.currentTask.completed = true;
                        elements.taskSubmit.classList.remove('hidden');
                    } else {
                        output.textContent = "Error: Shield unstable! Check your syntax.";
                        output.style.color = "var(--danger)";
                    }
                } catch (e) {
                    output.textContent = "Error: " + e.message;
                    output.style.color = "var(--danger)";
                }
            });
            
            container.appendChild(runBtn);
            elements.taskContent.appendChild(container);
        }

        // Create quick challenge task
        function createQuickChallenge(task) {
            const container = document.createElement('div');
            container.className = 'quick-challenge';
            
            const instruction = document.createElement('div');
            instruction.className = 'challenge-instruction';
            instruction.textContent = task.instruction;
            container.appendChild(instruction);
            
            const dragDropArea = document.createElement('div');
            dragDropArea.className = 'drag-drop-area';
            
            // Drag items (shuffled)
            const shuffledItems = [...task.items];
            shuffleArray(shuffledItems);
            
            const dragItems = document.createElement('div');
            dragItems.className = 'drag-items';
            
            shuffledItems.forEach(item => {
                const dragItem = document.createElement('div');
                dragItem.className = 'drag-item';
                dragItem.textContent = item;
                dragItem.draggable = true;
                
                dragItem.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', item);
                });
                
                dragItems.appendChild(dragItem);
            });
            
            // Drop targets
            const dropTargets = document.createElement('div');
            dropTargets.className = 'drop-targets';
            
            for (let i = 0; i < task.items.length; i++) {
                const dropTarget = document.createElement('div');
                dropTarget.className = 'drop-target';
                dropTarget.dataset.expected = task.correctOrder[i];
                dropTarget.textContent = `Position ${i + 1}`;
                
                dropTarget.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropTarget.classList.add('highlight');
                });
                
                dropTarget.addEventListener('dragleave', () => {
                    dropTarget.classList.remove('highlight');
                });
                
                dropTarget.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropTarget.classList.remove('highlight');
                    
                    const item = e.dataTransfer.getData('text/plain');
                    dropTarget.textContent = item;
                    dropTarget.dataset.value = item;
                    
                    // Check if all positions are filled
                    checkQuickChallengeCompletion();
                });
                
                dropTargets.appendChild(dropTarget);
            }
            
            dragDropArea.appendChild(dragItems);
            dragDropArea.appendChild(dropTargets);
            container.appendChild(dragDropArea);
            elements.taskContent.appendChild(container);
            
            function checkQuickChallengeCompletion() {
                const targets = document.querySelectorAll('.drop-target');
                let allFilled = true;
                let correct = true;
                
                targets.forEach(target => {
                    if (!target.dataset.value) {
                        allFilled = false;
                    } else if (target.dataset.value !== target.dataset.expected) {
                        correct = false;
                    }
                });
                
                if (allFilled) {
                    if (correct) {
                        gameState.currentTask.completed = true;
                        elements.taskSubmit.classList.remove('hidden');
                    } else {
                        // Show error message
                        const errorMsg = document.createElement('div');
                        errorMsg.style.color = "var(--danger)";
                        errorMsg.style.textAlign = "center";
                        errorMsg.style.marginTop = "15px";
                        errorMsg.textContent = "Not quite right! Try again.";
                        elements.taskContent.appendChild(errorMsg);
                    }
                }
            }
        }

        // Create learn a fact task
        function createLearnFact(task) {
            const container = document.createElement('div');
            container.className = 'learn-fact';
            
            const fact = document.createElement('div');
            fact.className = 'fact-content';
            fact.textContent = task.fact;
            container.appendChild(fact);
            
            const question = document.createElement('div');
            question.className = 'fact-question';
            question.textContent = task.question;
            container.appendChild(question);
            
            const options = document.createElement('div');
            options.className = 'fact-options';
            
            task.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'fact-option';
                optionElement.textContent = option;
                
                optionElement.addEventListener('click', () => {
                    // Remove selected class from all options
                    document.querySelectorAll('.fact-option').forEach(el => {
                        el.classList.remove('selected');
                    });
                    
                    // Add selected class to clicked option
                    optionElement.classList.add('selected');
                    
                    // Store selected answer
                    gameState.currentTask.selectedAnswer = index;
                    
                    // Show submit button
                    elements.taskSubmit.classList.remove('hidden');
                });
                
                options.appendChild(optionElement);
            });
            
            container.appendChild(options);
            elements.taskContent.appendChild(container);
        }

        // Check task answer
        function checkTaskAnswer() {
            const task = gameState.currentTask;
            let isCorrect = false;
            
            // Check answer based on task type
            switch (task.type) {
                case 'brain-teaser':
                case 'learn-fact':
                    isCorrect = (task.selectedAnswer === task.correctAnswer);
                    break;
                case 'memory-game':
                case 'coding-challenge':
                case 'quick-challenge':
                    isCorrect = task.completed;
                    break;
            }
            
            if (isCorrect) {
                // Play success sound if audio is enabled
                if (gameState.audioEnabled) {
                    audio.success.currentTime = 0;
                    audio.success.play();
                }
                
                // Add XP
                addXP(task.xp);
                
                // Mark task as completed
                gameState.completedTasks.push(task.id);
                gameState.taskCompleted = true;
                
                // Add random inventory item
                if (Math.random() > 0.7) { // 30% chance
                    const randomItem = inventoryItems[Math.floor(Math.random() * inventoryItems.length)];
                    if (!gameState.inventory.some(item => item.id === randomItem.id)) {
                        gameState.inventory.push(randomItem);
                        localStorage.setItem('chizelInventory', JSON.stringify(gameState.inventory));
                        showAchievement("You found a " + randomItem.name + "!", randomItem.icon);
                    }
                }
                
                // Show success message
                elements.taskContent.innerHTML = `
                    <div style="text-align: center;">
                        <h3 style="color: var(--success);">MISSION SUCCESS! üéâ</h3>
                        <p>You earned ${task.xp} XP!</p>
                        <p>Brainrot's power in this sector decreased by ${Math.floor(task.xp/2)}%!</p>
                        <button class="option-btn" style="margin-top: 20px;" id="next-task-btn">Next Challenge</button>
                    </div>
                `;
                
                // Add confetti effect
                createConfetti();
                
                // Show power up effect
                showPowerUpEffect();
                
                // Set up next task button
                document.getElementById('next-task-btn').addEventListener('click', () => {
                    elements.taskContainer.classList.remove('visible');
                    elements.thinkingBox.classList.remove('visible');
                    showTask(gameState.completedTasks.length);
                });
                
                // Check for achievements
                checkAchievements();
            } else {
                // Show try again message
                const errorMsg = document.createElement('div');
                errorMsg.style.textAlign = "center";
                errorMsg.style.marginTop = "20px";
                errorMsg.style.color = "var(--danger)";
                errorMsg.innerHTML = `
                    <p>Not quite right! Brainrot regenerated ${Math.floor(Math.random() * 5) + 1}% power!</p>
                    <p>Try again cadet!</p>
                `;
                elements.taskContent.appendChild(errorMsg);
                
                // Play error sound if audio is enabled
                if (gameState.audioEnabled) {
                    audio.notification.currentTime = 0;
                    audio.notification.play();
                }
            }
        }

        // Show final message
        function showFinalMessage() {
            elements.taskHeader.textContent = "MISSION ACCOMPLISHED!";
            elements.taskContent.innerHTML = `
                <div style="text-align: center;">
                    <h3 style="color: var(--success);">You're now a Skillionaire-in-training!</h3>
                    <p style="font-size: 1.2em; margin: 20px 0;">Brainrot's power reduced by ${Math.floor(gameState.xp/6)}% in this sector!</p>
                    <p>Keep training to unlock more weapons against Brainrot!</p>
                    <button class="option-btn" style="margin-top: 20px;" id="restart-btn">New Mission</button>
                    <button class="option-btn" style="margin-top: 10px; background: var(--zippy-color);" id="zippy-btn">Ask ZIPPY</button>
                </div>
            `;
            
            elements.taskContainer.classList.add('visible');
            
            // Add confetti effect
            createConfetti();
            
            // Set up restart button
            document.getElementById('restart-btn').addEventListener('click', () => {
                elements.taskContainer.classList.remove('visible');
                showStoryStep(0);
            });
            
            // Set up Zippy button
            document.getElementById('zippy-btn').addEventListener('click', () => {
                toggleZippyAssistant(true);
            });
        }

        // Add XP
        function addXP(amount) {
            gameState.xp += amount;
            updateXPDisplay();
            checkLevelUp();
            localStorage.setItem('chizelXP', gameState.xp.toString());
        }

        // Update XP display
        function updateXPDisplay() {
            elements.xpValue.textContent = gameState.xp;
            
            // Calculate XP percentage for current level
            const xpForNextLevel = gameState.level * 100;
            const xpInLevel = gameState.xp - ((gameState.level - 1) * 100);
            const xpPercentage = Math.min(100, (xpInLevel / xpForNextLevel) * 100);
            
            elements.xpBar.style.width = `${xpPercentage}%`;
        }

        // Check for level up
        function checkLevelUp() {
            const neededXP = gameState.level * 100;
            if (gameState.xp >= neededXP) {
                gameState.level++;
                updateLevel();
                showAchievement(`Level ${gameState.level} Unlocked!`, "‚¨ÜÔ∏è");
                
                // Add level-up power-up
                const powerUp = {
                    id: `level-${gameState.level}-boost`,
                    name: `Level ${gameState.level} Boost`,
                    description: `Special ability unlocked at level ${gameState.level}`,
                    icon: "‚ú®"
                };
                
                if (!gameState.inventory.some(item => item.id === powerUp.id)) {
                    gameState.inventory.push(powerUp);
                    localStorage.setItem('chizelInventory', JSON.stringify(gameState.inventory));
                }
            }
        }

        // Update level display
        function updateLevel() {
            elements.levelValue.textContent = gameState.level;
            localStorage.setItem('chizelLevel', gameState.level.toString());
        }

        // Toggle audio
        function toggleAudio() {
            gameState.audioEnabled = !gameState.audioEnabled;
            elements.audioToggle.textContent = gameState.audioEnabled ? "üîä" : "üîá";
        }

        // Create confetti effect
        function createConfetti() {
            const colors = ['#6C63FF', '#00F0FF', '#FFC107', '#FF10F0', '#39FF14'];
            
            for (let i = 0; i < 150; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.left = `${Math.random() * 100}vw`;
                confetti.style.width = `${Math.random() * 10 + 5}px`;
                confetti.style.height = `${Math.random() * 10 + 5}px`;
                confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
                confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                
                document.body.appendChild(confetti);
                
                // Remove confetti after animation
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }

        // Show power up effect
        function showPowerUpEffect() {
            elements.powerUpEffect.style.opacity = '1';
            if (gameState.audioEnabled) {
                audio.powerup.currentTime = 0;
                audio.powerup.play();
            }
            
            setTimeout(() => {
                elements.powerUpEffect.style.opacity = '0';
            }, 2000);
        }

        // Show achievement
        function showAchievement(title, icon) {
            elements.achievementBadge.querySelector('.badge-title').textContent = title;
            elements.achievementBadge.querySelector('.badge-icon').textContent = icon;
            
            if (gameState.audioEnabled) {
                audio.achievement.currentTime = 0;
                audio.achievement.play();
            }
            
            elements.achievementBadge.classList.add('visible');
            
            // Close button
            elements.achievementBadge.querySelector('.badge-close').addEventListener('click', () => {
                elements.achievementBadge.classList.remove('visible');
            }, { once: true });
        }

        // Check for unlocked achievements
        function checkAchievements() {
            // Quick Learner achievement (complete 3 tasks)
            if (gameState.completedTasks.length >= 3 && 
                !gameState.achievements.includes('quick-learner')) {
                gameState.achievements.push('quick-learner');
                localStorage.setItem('chizelAchievements', JSON.stringify(gameState.achievements));
                showAchievement("Quick Learner", "üèéÔ∏è");
                addXP(20);
            }
            
            // Knowledge Knight achievement (earn 500 XP)
            if (gameState.xp >= 500 && 
                !gameState.achievements.includes('knowledge-knight')) {
                gameState.achievements.push('knowledge-knight');
                localStorage.setItem('chizelAchievements', JSON.stringify(gameState.achievements));
                showAchievement("Knowledge Knight", "üõ°Ô∏è");
                addXP(75);
            }
        }

        // Toggle inventory panel
        function toggleInventory() {
            if (elements.inventoryPanel.classList.contains('visible')) {
                elements.inventoryPanel.classList.remove('visible');
            } else {
                updateInventoryPanel();
                elements.inventoryPanel.classList.add('visible');
            }
        }

        // Update inventory panel
        function updateInventoryPanel() {
            elements.inventoryPanel.innerHTML = '';
            
            if (gameState.inventory.length === 0) {
                const emptyMsg = document.createElement('div');
                emptyMsg.textContent = "Your inventory is empty. Complete challenges to find items!";
                emptyMsg.style.gridColumn = "1 / -1";
                emptyMsg.style.textAlign = "center";
                emptyMsg.style.padding = "20px";
                emptyMsg.style.color = "var(--light)";
                elements.inventoryPanel.appendChild(emptyMsg);
                return;
            }
            
            gameState.inventory.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'inventory-item';
                itemElement.innerHTML = `
                    <div class="item-icon">${item.icon}</div>
                    <div class="item-name">${item.name}</div>
                `;
                
                itemElement.addEventListener('click', () => {
                    // Show item info
                    elements.thinkingContent.textContent = `${item.name}: ${item.description}`;
                    elements.thinkingBox.classList.add('visible');
                    
                    // Hide after delay
                    setTimeout(() => {
                        elements.thinkingBox.classList.remove('visible');
                    }, 3000);
                });
                
                elements.inventoryPanel.appendChild(itemElement);
            });
        }

        // Toggle Zippy AI assistant
        function toggleZippyAssistant(show) {
            if (show) {
                elements.zippyAssistant.classList.add('visible');
                elements.zippyInput.focus();
            } else {
                elements.zippyAssistant.classList.remove('visible');
                elements.zippyInput.value = '';
            }
        }

        // Handle Zippy query
        function handleZippyQuery() {
            const query = elements.zippyInput.value.trim().toLowerCase();
            if (!query) return;
            
            // Find matching knowledge
            let response = "I'm not sure about that. Try asking about: Brainrot, Chizel, XP, weapons, or achievements.";
            
            for (const [keyword, info] of Object.entries(gameState.zippyKnowledge)) {
                if (query.includes(keyword)) {
                    response = info;
                    break;
                }
            }
            
            // Special responses
            if (query.includes('hello') || query.includes('hi')) {
                response = "Greetings cadet! Ready to continue the fight against Brainrot?";
            } else if (query.includes('thank')) {
                response = "You're welcome! Remember, every bit of knowledge helps defeat Brainrot!";
            } else if (query.includes('mission')) {
                response = `Current mission progress: ${gameState.storyProgress.toFixed(1)}% complete. ${gameState.completedTasks.length} of ${tasks.length} tasks completed.`;
            }
            
            elements.zippyMessage.textContent = response;
            elements.zippyInput.value = '';
        }

        // Utility function to shuffle array
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Initialize the game when DOM is loaded
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>